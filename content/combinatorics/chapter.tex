\section{Combinatorics}

\begin{myitemize}
	\item Catalan numbers (valid bracket seq's of length $2n$):

		$C_0 = 1, C_n = \frac{1}{n+1}\binom{2n}{n} = \sum_{i=0}^{n-1}C_iC_{n-i-1}$.

	\item Stirling 1\textsuperscript{th} kind ($\# \pi \in \mathfrak{S}_n$ with exactly $k$ cycles):

		$\left[{n\atop 0}\right]=\left[{0\atop n}\right] = \delta_{0n}, \left[{n\atop k}\right]=(n-1)\left[{n-1\atop k}\right]+\left[{n-1\atop k-1}\right]$.

	\item Stirling 2\textsuperscript{nd} kind ($k$-partitions of $[n]$):

		$\left\{{n\atop 1}\right\}=\left\{{n\atop n}\right\}=1, \left\{{n\atop k}\right\} = k \left\{{ n-1 \atop k }\right\} + \left\{{n-1\atop k-1}\right\}$.

    \item Bell numbers (partitions of $[n]$):

		$B_0 = 1, B_n = \sum_{k=0}^{n-1} B_k \binom{n-1}{k} = \sum_{k=0}^n\left\{{n\atop k}\right\}$.

	\item Euler ($\# \pi \in \mathfrak{S}_n$ with exactly $k$ ascents):

		$\left \langle {n\atop 0} \right \rangle = \left \langle {n\atop n-1} \right \rangle = 1, \left \langle {n\atop k} \right \rangle = (k+1) \left \langle {n-1\atop {k}} \right \rangle + (n-k)\left \langle {{n-1}\atop {k-1}} \right \rangle$.

	\item Euler 2\textsuperscript{nd} order (nr perms of ${1, 1, 2, 2, \dots, n, n}$ with exactly $k$ ascents):

		$\left \langle \!\!\left \langle {n\atop k} \right \rangle \!\! \right \rangle = (k+1) \left \langle \!\! \left \langle {{n-1}\atop {k}} \right \rangle \!\! \right \rangle +(2n-k-1)\left \langle \!\! \left \langle {{n-1}\atop {k-1}} \right \rangle  \!\! \right \rangle$.
	%	$\left \langle {n\atop 0} \right \rangle = \left \langle {n\atop n-1} \right \rangle = 1, \left \langle {n\atop k} \right \rangle = (k+1) \left \langle {n-1\atop {k}} \right \rangle + (n-k)\left \langle {{n-1}\atop {k-1}} \right \rangle$.

	\item Rooted trees: $n^{n-1}$, unrooted: $n^{n-2}$.
	\item Forests of $k$ rooted trees: $\binom{n}{k} k \cdot n^{n-k-1}$.
	\item $\sum_{i=1}^n \binom{n}{i} F_i = F_{2n}$, \quad $\sum_{i} \binom{n-i}{i} = F_{n+1}$
	\item $\sum_{k=0}^n \binom{k}{m} = \binom{n+1}{m+1}$, \quad $x^k = \sum_{i=0}^k i!\stirling{k}{i}\binom{x}{i} = \sum_{i=0}^k \left\langle {k \atop i} \right\rangle\binom{x+i}{k}$
	\item $a\equiv b \pmod{x,y} \Leftrightarrow a \equiv b \pmod{\mathrm{lcm}(x,y)}$.
	\item $ac \equiv bc \pmod{m} \Leftrightarrow a \equiv b \pmod{m/\mathrm{gcd}(c,m)}$.
	\item $\mathrm{gcd}(n^a-1,n^b-1) = \mathrm{gcd}(a,b)-1$.
	\item \textbf{MÃ¶bius inversion formula:} If $f(n) = \sum_{d|n} g(d)$, then $g(n) = \sum_{d|n} \mu(d) f(n/d)$. If $f(n) = \sum_{m=1}^n g(\lfloor n/m\rfloor)$, then $g(n) = \sum_{m=1}^n \mu(m)f(\lfloor\frac{n}{m}\rfloor)$.
	\item \textbf{Inclusion-Exclusion:} If $g(T) = \sum_{S \subseteq T} f(S)$, then
	\[
		f(T) = \sum_{S \subseteq T} (-1)^{\lvert T \setminus S \rvert} g(T).
	\]
	Corollary:
		$b_n = \sum_{k=0}^{n} \binom{n}{k} a_k \Longleftrightarrow a_n = \sum_{k=0}^{n} (-1)^{n-k} \binom{n}{k} b_k$.
\end{myitemize}

\subsection{The Twelvefold Way}
Putting $n$ balls into $k$ boxes.
$\mathrm{p}(n,k)$ is \# partitions of $n$ in $k$ parts, each $>0$.
$\mathrm{p}_k(n) = \sum_{i=0}^k \mathrm{p}(n,k)$.

\begin{tabular}{@{}c|c|c|c|c|l@{}}
	Balls & same & distinct & same & distinct\\
	Boxes & same & same & distinct & distinct\\
	\hline
	- & $\mathrm{p}_k(n)$ & $\sum_{i=0}^k \stirling{n}{i}$ & $\binom{n+k-1}{k-1}$ & $k^n$ \\ 
	$\mathrm{size}\ge 1$ & $\mathrm{p}(n,k)$ & $\stirling{n}{k}$ & $\binom{n-1}{k-1}$ & $k!\stirling{n}{k}$ \\
	$\mathrm{size}\le 1$ & $[n \le k]$ & $[n \le k]$ & $\binom{k}{n}$ & $n!\binom{k}{n}$ \\
	\bottomrule
\end{tabular}

\subsection{Game Theory}
	A game can be reduced to Nim if it is a finite impartial game.
	Nim and its variants include:
	\begin{myitemize}
		\item \textbf{Nim:} Let $X = \bigoplus_{i=1}^n x_i$, then $(x_i)_{i=1}^n$ is a winning position iff $X\neq 0$. Find a move by picking $k$ such that $x_k > x_k \oplus X$.
		\item \textbf{Mis\`{e}re Nim:} Regular Nim, except that the last player to move \textit{loses}. Play regular Nim until there is only one pile of size larger than $1$, reduce it to $0$ or $1$ such that there is an odd number of piles. The second player wins $(a_1, \dots, a_n)$ if 1) there is a pile $a_i > 1$ and $\oplus_{i=1}^{n} a_i = 0$ or 2) all $a_i \leq 1$ and $\oplus_{i=1}^{n} a_i = 1$.
		\item \textbf{Staircase Nim:} Stones are moved down a staircase and only removed from the last pile. $(x_i)_{i=1}^n$ is an $L$-position if $(x_{2i-1})_{i=1}^{n/2}$ is (i.e. only look at odd-numbered piles).
		\item \textbf{Moore's Nim$_k$:} The player may remove from at most $k$ piles (Nim $=$ Nim$_1$). Expand the piles in base $2$, do a carry-less addition in base $k+1$ (i.e. the number of ones in each column should be divisible by $k+1$).
		\item \textbf{Dim$^+$:} The number of removed stones must be a divisor of the pile size. The Sprague-Grundy function is $k+1$ where $2^k$ is the largest power of $2$ dividing the pile size.
		\item \textbf{Aliquot game:} Same as above, except the divisor should be proper (hence $1$ is also a terminal state, but watch out for size $0$ piles). Now the Sprague-Grundy function is just $k$.
		\item \textbf{Nim (at most half):} Write $n+1 = 2^my$ with $m$ maximal, then the Sprague-Grundy function of $n$ is $(y - 1) / 2$.
		\item \textbf{Lasker's Nim:} Players may alternatively split a pile into two new non-empty piles. $g(4k+1) = 4k+1$, $g(4k+2) = 4k+2$, $g(4k+3) = 4k+4$, $g(4k+4) = 4k+3$ ($k\geq 0$).
		\item \textbf{Hackenbush on trees:} A tree with stalks $(x_i)_{i=1}^n$ may be replaced with a single stalk with length $\bigoplus_{i=1}^n x_i$.
	\end{myitemize}

\subsection{Permutations}
	\subsubsection{Factorial}
		\import{factorial.tex}

		% Just use next_permutation to make a lookup-table of all permutations.
		% \kactlimport{IntPerm.h}

	\subsubsection{Cycles}
		Let $g_S(n)$ be the number of $n$-permutations whose cycle lengths all belong to the set $S$. Then
		$$\sum_{n=0} ^\infty g_S(n) \frac{x^n}{n!} = \exp\left(\sum_{n\in S} \frac{x^n} {n} \right)$$

	\subsubsection{Derangements}
		Permutations of a set such that none of the elements appear in their original position.
		\[ \mkern-2mu D(n) = (n-1)(D(n-1)+D(n-2)) = n D(n-1)+(-1)^n = \left\lfloor\frac{n!}{e}\right\rceil \]

	\subsubsection{Burnside's lemma}
		Given a group $G$ of symmetries and a set $X$, the number of elements of $X$ \emph{up to symmetry} equals
		 \[ {\frac {1}{|G|}}\sum _{{g\in G}}|X^{g}|, \]
		 where $X^{g} = \set{ x \in X | gx = x}$.

		 If $f(n)$ counts ``configurations'' (of some sort) of length $n$, we can ignore rotational symmetry using $G = \mathbb Z_n$ to get
		 \[ g(n) = \frac 1 n \sum_{k=0}^{n-1}{f(\text{gcd}(n, k))} = \frac 1 n \sum_{k|n}{f(k)\phi(n/k)}. \]

\subsection{Partitions and subsets}
	\subsubsection{Partition function}
		Number of ways of writing $n$ as a sum of positive integers, disregarding the order of the summands.
		\[ p(0) = 1,\ p(n) = \sum_{k \in \mathbb Z \setminus \{0\}}{(-1)^{k+1} p(n - k(3k-1) / 2)} \]
		\[ p(n) \sim 0.145 / n \cdot \exp(2.56 \sqrt{n}) \]

		\begin{center}
		\begin{tabular}{c|c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c@{\ }c}
			$n$    & 0 & 1 & 2 & 3 & 4 & 5 & 6  & 7  & 8  & 9  & 20  & 50  & 100 \\ \hline
			$p(n)$ & 1 & 1 & 2 & 3 & 5 & 7 & 11 & 15 & 22 & 30 & 627 & $\mathtt{\sim}$2e5 & $\mathtt{\sim}$2e8 \\
		\end{tabular}
		\end{center}

	\subsubsection{Binomials}
		\kactlimport{binomialModPrime.h}
		\kactlimport{multinomial.h}
